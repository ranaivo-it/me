<!DOCTYPE html>
<html lang="en-us">
    <head>
        <meta charset="utf-8">
        <meta name="viewport" content="width=device-width, initial-scale=1">
        <meta name="robots" content="noodp" />
        <meta http-equiv="X-UA-Compatible" content="IE=edge, chrome=1">
        <title>Pandas Best Practices - Mahery Ranaivoson | Blog</title><meta name="Description" content="Pandas tutorial"><meta property="og:title" content="Pandas Best Practices" />
<meta property="og:description" content="Pandas tutorial" />
<meta property="og:type" content="article" />
<meta property="og:url" content="https://ranaivo-it.github.io/me/posts/pandas-best-practice/" /><meta property="og:image" content="https://ranaivo-it.github.io/images/twitter-card.png"/><meta property="article:section" content="posts" />
<meta property="article:published_time" content="2020-09-27T01:46:24+02:00" />
<meta property="article:modified_time" content="2022-08-03T15:58:26+02:00" />

<meta name="twitter:card" content="summary_large_image"/>
<meta name="twitter:image" content="https://ranaivo-it.github.io/images/twitter-card.png"/>

<meta name="twitter:title" content="Pandas Best Practices"/>
<meta name="twitter:description" content="Pandas tutorial"/>
<meta name="application-name" content="Mahery Ranaivoson">
<meta name="apple-mobile-web-app-title" content="Mahery Ranaivoson"><meta name="theme-color" content="#ffffff"><meta name="msapplication-TileColor" content="#da532c"><link rel="shortcut icon" type="image/x-icon" href="https://ranaivo-it.github.io/me/favicon.ico" />
        <link rel="icon" type="image/png" sizes="32x32" href="https://ranaivo-it.github.io/me/favicon-32x32.png">
        <link rel="icon" type="image/png" sizes="16x16" href="https://ranaivo-it.github.io/me/favicon-16x16.png"><link rel="apple-touch-icon" sizes="180x180" href="https://ranaivo-it.github.io/me/apple-touch-icon.png"><link rel="mask-icon" href="https://ranaivo-it.github.io/me/safari-pinned-tab.svg" color="#5bbad5"><link rel="manifest" href="https://ranaivo-it.github.io/me/site.webmanifest"><link rel="canonical" href="https://ranaivo-it.github.io/me/posts/pandas-best-practice/" /><link rel="stylesheet" href="https://ranaivo-it.github.io/me/lib/normalize/normalize.min.css"><link rel="stylesheet" href="https://ranaivo-it.github.io/me/css/style.min.css"><link rel="stylesheet" href="https://ranaivo-it.github.io/me/lib/fontawesome-free/all.min.css"><link rel="stylesheet" href="https://ranaivo-it.github.io/me/lib/animate/animate.min.css"><script type="application/ld+json">
    {
        "@context": "http://schema.org",
        "@type": "BlogPosting",
        "headline": "Pandas Best Practices",
        "inLanguage": "en-us",
        "mainEntityOfPage": {
            "@type": "WebPage",
            "@id": "https:\/\/ranaivo-it.github.io\/me\/posts\/pandas-best-practice\/"
        },"genre": "posts","keywords": "pandas, data_analysis","wordcount":  2680 ,
        "url": "https:\/\/ranaivo-it.github.io\/me\/posts\/pandas-best-practice\/","datePublished": "2020-09-27T01:46:24+02:00","dateModified": "2022-08-03T15:58:26+02:00","publisher": {
            "@type": "Organization",
            "name": "Mahery Ranaivoson"},"author": {
                "@type": "Person",
                "name": "Mahery Ranaivoson"
            },"description": "Pandas tutorial"
    }
    </script></head>
    <body header-desktop="fixed" header-mobile="auto"><script type="text/javascript">(window.localStorage && localStorage.getItem('theme') ? localStorage.getItem('theme') === 'dark' : ('auto' === 'auto' ? window.matchMedia('(prefers-color-scheme: dark)').matches : 'auto' === 'dark')) && document.body.setAttribute('theme', 'dark');</script>

        <div id="mask"></div><div class="wrapper"><header class="desktop" id="header-desktop">
    <div class="header-wrapper">
        <div class="header-title">
            <a href="https://ranaivo-it.github.io/me/" title="Mahery Ranaivoson | Blog"><img
        class="lazyload logo"
        src="https://ranaivo-it.github.io/me/svg/loading.min.svg"
        data-src="https://ranaivo-it.github.io/me/images/logo.png"
        data-srcset="https://ranaivo-it.github.io/me/images/logo.png, https://ranaivo-it.github.io/me/images/logo.png 1.5x, https://ranaivo-it.github.io/me/images/logo.png 2x"
        data-sizes="auto"
        alt="/images/logo.png"
        title="/images/logo.png" /></a>
        </div>
        <div class="menu">
            <div class="menu-inner"><a class="menu-item" href="https://ranaivo-it.github.io/me/posts/"> Posts </a><a class="menu-item" href="https://ranaivo-it.github.io/me/categories/"> Categories </a><a class="menu-item" href="https://ranaivo-it.github.io/me/tags/"> Tags </a><a class="menu-item" href="https://github.com/naivomah3" title="My GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i>  </a><span class="menu-item delimiter"></span><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                    <i class="fas fa-adjust fa-fw"></i>
                </a>
            </div>
        </div>
    </div>
</header><header class="mobile" id="header-mobile">
    <div class="header-container">
        <div class="header-wrapper">
            <div class="header-title">
                <a href="https://ranaivo-it.github.io/me/" title="Mahery Ranaivoson | Blog"><img
        class="lazyload logo"
        src="https://ranaivo-it.github.io/me/svg/loading.min.svg"
        data-src="https://ranaivo-it.github.io/me/images/logo.png"
        data-srcset="https://ranaivo-it.github.io/me/images/logo.png, https://ranaivo-it.github.io/me/images/logo.png 1.5x, https://ranaivo-it.github.io/me/images/logo.png 2x"
        data-sizes="auto"
        alt="/images/logo.png"
        title="/images/logo.png" /></a>
            </div>
            <div class="menu-toggle" id="menu-toggle-mobile">
                <span></span><span></span><span></span>
            </div>
        </div>
        <div class="menu" id="menu-mobile"><a class="menu-item" href="https://ranaivo-it.github.io/me/posts/" title="">Posts</a><a class="menu-item" href="https://ranaivo-it.github.io/me/categories/" title="">Categories</a><a class="menu-item" href="https://ranaivo-it.github.io/me/tags/" title="">Tags</a><a class="menu-item" href="https://github.com/naivomah3" title="My GitHub" rel="noopener noreffer" target="_blank"><i class='fab fa-github fa-fw'></i></a><a href="javascript:void(0);" class="menu-item theme-switch" title="Switch Theme">
                <i class="fas fa-adjust fa-fw"></i>
            </a></div>
    </div>
</header>
<div class="search-dropdown desktop">
    <div id="search-dropdown-desktop"></div>
</div>
<div class="search-dropdown mobile">
    <div id="search-dropdown-mobile"></div>
</div>
<main class="main">
                <div class="container"><div class="toc" id="toc-auto">
            <h2 class="toc-title">Contents</h2>
            <div class="toc-content" id="toc-content-auto"></div>
        </div><article class="page single"><h1 class="single-title animated flipInX">Pandas Best Practices</h1><div class="post-meta">
            <div class="post-meta-line"><span class="post-author"><a href="https://ranaivo-it.github.io/me/" title="Author" rel=" author" class="author"><i class="fas fa-user-circle fa-fw"></i>Mahery Ranaivoson</a></span>&nbsp;<span class="post-category">included in <a href="https://ranaivo-it.github.io/me/categories/data-analysis/"><i class="far fa-folder fa-fw"></i>Data Analysis</a></span></div>
            <div class="post-meta-line"><i class="far fa-calendar-alt fa-fw"></i>&nbsp;<time datetime="Sep 27, 2020">Sep 27, 2020</time>&nbsp;<i class="fas fa-pencil-alt fa-fw"></i>&nbsp;2680 words&nbsp;
                <i class="far fa-clock fa-fw"></i>&nbsp;13 minutes&nbsp;</div>
        </div><div class="featured-image"><img
        class="lazyload"
        src="https://ranaivo-it.github.io/me/svg/loading.min.svg"
        data-src="https://ranaivo-it.github.io/me/posts/pandas-best-practice/pandas.png"
        data-srcset="https://ranaivo-it.github.io/me/posts/pandas-best-practice/pandas.png, https://ranaivo-it.github.io/me/posts/pandas-best-practice/pandas.png 1.5x, https://ranaivo-it.github.io/me/posts/pandas-best-practice/pandas.png 2x"
        data-sizes="auto"
        alt="/posts/pandas-best-practice/pandas.png"
        title="Pandas tutorial" /></div><div class="details toc" id="toc-static"  kept="">
                <div class="details-summary toc-title">
                    <span>Contents</span>
                    <span><i class="details-icon fas fa-angle-right"></i></span>
                </div>
                <div class="details-content toc-content" id="toc-content-static"><nav id="TableOfContents">
  <ul>
    <li><a href="#what-is-pandas">What is Pandas?</a></li>
    <li><a href="#installation">Installation</a></li>
    <li><a href="#pandas-components">Pandas components</a></li>
    <li><a href="#dataset">Dataset</a></li>
    <li><a href="#best-practices">Best practices</a>
      <ul>
        <li><a href="#1-importing-necessary-libraries">1. Importing necessary libraries</a></li>
        <li><a href="#2-get-to-know-the-dataset">2. Get to know the dataset</a></li>
        <li><a href="#3-generate-data-sample-and-rename-columns">3. Generate data sample and rename columns</a></li>
        <li><a href="#4-reverse-row-and-column-order">4. Reverse row and column order</a></li>
        <li><a href="#5-missing-data">5. Missing data</a></li>
        <li><a href="#6-split-cells-data">6. Split cells data</a></li>
        <li><a href="#7-filter-a-dataframe">7. Filter a dataframe</a></li>
      </ul>
    </li>
  </ul>
</nav></div>
            </div><div class="content" id="content"><div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>What is this article about?<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content">This article provides a curated list of the daily best practices and use cases of the Pandas library. It is meant to be a rolling release note in which I will mark down all of the better practice I came across along my journey towards data science. Accordingly, the list is going to be (very) long thus feel free to use the table of contents to jump over to the topic you may interest.</div>
        </div>
    </div>
<h2 id="what-is-pandas">What is Pandas?</h2>
<figure><a class="lightgallery" href="https://ranaivo-it.github.io/me/posts/pandas-best-practice/not_pandas.jpg" title="credit: www.unsplash.com" data-thumbnail="/posts/pandas-best-practice/not_pandas.jpg" data-sub-html="<h2>This is not a Panda or the Pandas I&rsquo;m talking about.</h2><p>credit: www.unsplash.com</p>">
        <img
            class="lazyload"
            src="https://ranaivo-it.github.io/me/svg/loading.min.svg"
            data-src="https://ranaivo-it.github.io/me/posts/pandas-best-practice/not_pandas.jpg"
            data-srcset="https://ranaivo-it.github.io/me/posts/pandas-best-practice/not_pandas.jpg, https://ranaivo-it.github.io/me/posts/pandas-best-practice/not_pandas.jpg 1.5x, https://ranaivo-it.github.io/me/posts/pandas-best-practice/not_pandas.jpg 2x"
            data-sizes="auto"
            alt="/posts/pandas-best-practice/not_pandas.jpg" />
    </a><figcaption class="image-caption">This is not a Panda or the Pandas I&rsquo;m talking about.</figcaption>
    </figure>
<p><strong><a href="https://pandas.pydata.org/docs/getting_started/index.html" target="_blank" rel="noopener noreffer">Pandas</a></strong> is one of the most-used standard Python library when dealing with matrix-like transformable datasets which range from a simple tabular to a more complex structure dataset. It is an open-source library providing faster, flexible, and expressive mean for data manipulation and one of the essential to learn library in case you are getting in the data science field.<br>
It mainly provides two well-suited data structures to multiple data type include <strong>Series</strong> and <strong>DataFrame</strong>. This article will get into how to use both of them and the case on which one may be helpful over the other in the following.</p>
<h2 id="installation">Installation</h2>
<p>Pandas can be installed via pip from <strong><a href="https://pypi.org/project/pandas/" target="_blank" rel="noopener noreffer">PyPI</a></strong></p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">pip install pandas
</span></span></code></pre></td></tr></table>
</div>
</div><p>or using the <a href="https://docs.anaconda.com/anaconda/install/" target="_blank" rel="noopener noreffer">Anaconda</a> or <a href="https://docs.conda.io/en/latest/miniconda.html" target="_blank" rel="noopener noreffer">Miniconda</a> environment,</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">conda install pandas
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="pandas-components">Pandas components</h2>
<p>As mentioned earlier and to handle different types of datasets, pandas provides 2 data structures mainly wrapped over Numpy. <code>Series</code> is nothing but one dimension representation similar to the Numpy array but structured in the way it is explicitly associate an index with the values. Whereas <code>DataFrame</code> is a multi-dimensional array that can be thought of as a collection of series and its rows are also indexed by default unless it is explicitly done. They are pretty similar in terms of operations as one can apply almost the same manipulation to both of them.</p>
<figure><img src="https://ranaivo-it.github.io/me/posts/pandas-best-practice/pandas_main_comps.png"
         alt="credit: www.learndatasci.com" width="600" height="500"/><figcaption>
            <h4>Pandas main components</h4>
        </figcaption>
</figure>

<h2 id="dataset">Dataset</h2>
<p>The dataset being used in the following is either being created manually or loaded from Seaborn repository or the dataset <strong><a href="https://www.kaggle.com/faressayah/stanford-open-policing-project/notebooks" target="_blank" rel="noopener noreffer">Traffic and Pedestrian Stops</a></strong> by the Police in Rhode Island to make advanced operations. The choice lies in the fact that this dataset has multiple data types from which multiple scenarios can be derived.</p>
<h2 id="best-practices">Best practices</h2>
<h3 id="1-importing-necessary-libraries">1. Importing necessary libraries</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span> 
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">seaborn</span> <span class="k">as</span> <span class="nn">sns</span>
</span></span><span class="line"><span class="cl"><span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span> 
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># whether to explicitly show the whole interactive output cells in </span>
</span></span><span class="line"><span class="cl"><span class="c1"># jupyter notebook rather than showing only the last line.</span>
</span></span><span class="line"><span class="cl"><span class="c1"># use `last_expr` to revert back the default behavior</span>
</span></span><span class="line"><span class="cl"><span class="kn">from</span> <span class="nn">IPython.core.interactiveshell</span> <span class="kn">import</span> <span class="n">InteractiveShell</span>
</span></span><span class="line"><span class="cl"><span class="n">InteractiveShell</span><span class="o">.</span><span class="n">ast_node_interactivity</span> <span class="o">=</span> <span class="s2">&#34;all&#34;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># whether to display all DataFrame rows and cols </span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_rows&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">pd</span><span class="o">.</span><span class="n">set_option</span><span class="p">(</span><span class="s1">&#39;display.max_columns&#39;</span><span class="p">,</span> <span class="kc">None</span><span class="p">)</span>  
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition info open">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-info-circle fa-fw"></i>Info<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><ul>
<li>For the full data analysis and visualization tasks, pandas is often incomplete and you need to have hands-on skills to other Python libraries like Numpy, Matplotlib or Seaborn but they are not mandatory. They are only used here to help us generating dataset or ploting important findings.</li>
<li>In this article, additional information about the code is explained using Python comments.</li>
</ul>
</div>
        </div>
    </div>
<h3 id="2-get-to-know-the-dataset">2. Get to know the dataset</h3>
<p>This is the first essential tasks that you would perform before getting started your analysis. Understanding the dataset may extend from knowing what&rsquo;s inside, its content, its shape, the variable names, the variable datatypes, the ratio of null values, or going deeper to know the number of unique values of categorical variables, or even gather the descriptive statistics or the variable distribution. The following code snippet shows a few essential functions along with the must to know arguments to answer these questions.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="n">police</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/police_project.csv&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                 <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                 <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stop_date&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                 <span class="n">index_col</span><span class="o">=</span><span class="kc">None</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                 <span class="n">usecols</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stop_date&#39;</span><span class="p">,</span> <span class="s1">&#39;driver_gender&#39;</span><span class="p">,</span><span class="s1">&#39;driver_age_raw&#39;</span><span class="p">,</span> <span class="s1">&#39;violation&#39;</span><span class="p">])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">info</span><span class="p">(</span><span class="n">memory_usage</span><span class="o">=</span><span class="s1">&#39;deep&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Whether to display all columns with their respective types </span>
</span></span><span class="line"><span class="cl"><span class="c1">#police.columns.to_series().groupby(police.dtypes).groups</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Only filter `number`, `datetime`, and `object` types</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">dropna</span><span class="p">()</span><span class="o">.</span><span class="n">describe</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="n">np</span><span class="o">.</span><span class="n">number</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">datetime64</span><span class="p">,</span> <span class="n">np</span><span class="o">.</span><span class="n">object</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">select_dtypes</span><span class="p">(</span><span class="n">include</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;number&#39;</span><span class="p">,</span> <span class="s1">&#39;object&#39;</span><span class="p">])</span><span class="o">.</span><span class="n">describe</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition question">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-question-circle fa-fw"></i>Output<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p><strong><code>df.read_csv()</code></strong> is one of the most common Pandas method designed specifically, but not limited to, to read a CSV data source. By default, CSV columns are separated by comma <code>,</code> as the name stands for but sometimes the data source comes with different column character separation such as <code>;</code>, <code>|</code>,<code>\tab</code>. In such case, you can explicitly specify the separation character using the argument <code>sep</code>. Here, the argument <code>parse_dates</code> is used to format the date column to be of type <code>datetime</code> and <code>index_col</code> is the way to set some variable as the DataFrame index. You can pass a list of columns to this argument. Using <code>usecols</code>, you can define a set of columns in which you are about to perform the analysis.</p>
<br>
<p><strong><code>df.head(3)</code></strong> shows the top 3 rows. You can specify as many rows as you want. Without specification, it will give the top 5 rows.</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stop_date</th>
      <th>driver_gender</th>
      <th>driver_age</th>
      <th>violation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2005-01-02</td>
      <td>M</td>
      <td>20.0</td>
      <td>Speeding</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2005-01-18</td>
      <td>M</td>
      <td>40.0</td>
      <td>Speeding</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2005-01-23</td>
      <td>M</td>
      <td>33.0</td>
      <td>Speeding</td>
    </tr>
  </tbody>
</table>
<br>
<p><strong><code>df.info()</code></strong> will trough us some important properties of the entire dataset. By specifying <code>memory_usage='deep'</code> it will introspect and return the exact amount of memory consumption.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">  RangeIndex: <span class="m">91741</span> entries, <span class="m">0</span> to <span class="m">91740</span>
</span></span><span class="line"><span class="cl">  Data columns <span class="o">(</span>total <span class="m">4</span> columns<span class="o">)</span>:
</span></span><span class="line"><span class="cl">    <span class="c1">#   Column         Non-Null Count  Dtype         </span>
</span></span><span class="line"><span class="cl">  ---  ------         --------------  -----         
</span></span><span class="line"><span class="cl">    <span class="m">0</span>   stop_date      <span class="m">91741</span> non-null  datetime64<span class="o">[</span>ns<span class="o">]</span>
</span></span><span class="line"><span class="cl">    <span class="m">1</span>   driver_gender  <span class="m">86406</span> non-null  object        
</span></span><span class="line"><span class="cl">    <span class="m">2</span>   driver_age     <span class="m">86120</span> non-null  float64       
</span></span><span class="line"><span class="cl">    <span class="m">3</span>   violation      <span class="m">86408</span> non-null  object        
</span></span><span class="line"><span class="cl">  dtypes: datetime64<span class="o">[</span>ns<span class="o">](</span>1<span class="o">)</span>, float64<span class="o">(</span>1<span class="o">)</span>, object<span class="o">(</span>2<span class="o">)</span>
</span></span><span class="line"><span class="cl">  memory usage: 12.0 MB
</span></span></code></pre></td></tr></table>
</div>
</div><br> 
<p><strong><code>dropna().describe()</code></strong> and <strong><code>dropna().select_dtypes().describe()</code></strong> are here used to get a quick summary of statistics by filtered columns by the data types. <code>include=[np.number, np.datetime64, np.object]</code> and <code>select_dtypes(include=['number'])</code> filter out columns by data types and by default the first one will include all the columns whereas the second will through an error as <code>select_dtypes()</code> required at least one parameter. The first doesn&rsquo;t have any effect in this case as all the dataset dtypes are including in the list whereas the second only outputs column number of type <code>number</code> which is here <code>driver_age_raw</code>. To get a quick summary of columns datatypes grouped by columns, you can uncomment the code at the <code>line 9</code>. We can notice from the first output that some of the outputs are <code>NaN</code> and that is so because properties are data types dependent which means those that can apply to object data cannot apply to other data types and vice-versa.</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stop_date</th>
      <th>driver_gender</th>
      <th>driver_age_raw</th>
      <th>violation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>86405</td>
      <td>86405</td>
      <td>86405.000000</td>
      <td>86405</td>
    </tr>
    <tr>
      <th>unique</th>
      <td>3767</td>
      <td>2</td>
      <td>NaN</td>
      <td>6</td>
    </tr>
    <tr>
      <th>top</th>
      <td>2012-02-28 00:00:00</td>
      <td>M</td>
      <td>NaN</td>
      <td>Speeding</td>
    </tr>
    <tr>
      <th>freq</th>
      <td>64</td>
      <td>62895</td>
      <td>NaN</td>
      <td>48461</td>
    </tr>
    <tr>
      <th>first</th>
      <td>2005-01-02 00:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>last</th>
      <td>2015-12-31 00:00:00</td>
      <td>NaN</td>
      <td>NaN</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1970.536080</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>std</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>110.514739</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>min</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>0.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1967.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1980.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>1987.000000</td>
      <td>NaN</td>
    </tr>
    <tr>
      <th>max</th>
      <td>NaN</td>
      <td>NaN</td>
      <td>8801.000000</td>
      <td>NaN</td>
    </tr>
  </tbody>
</table>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>driver_age_raw</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>count</th>
      <td>86414.000000</td>
    </tr>
    <tr>
      <th>mean</th>
      <td>1970.491228</td>
    </tr>
    <tr>
      <th>std</th>
      <td>110.914909</td>
    </tr>
    <tr>
      <th>min</th>
      <td>0.000000</td>
    </tr>
    <tr>
      <th>25%</th>
      <td>1967.000000</td>
    </tr>
    <tr>
      <th>50%</th>
      <td>1980.000000</td>
    </tr>
    <tr>
      <th>75%</th>
      <td>1987.000000</td>
    </tr>
    <tr>
      <th>max</th>
      <td>8801.000000</td>
    </tr>
  </tbody>
</table>
<br>
</div>
        </div>
    </div>
<h3 id="3-generate-data-sample-and-rename-columns">3. Generate data sample and rename columns</h3>
<p>Generating synthetic sample may help us in some situation like conducting an experiment, for instance, testing algorithms, making visualization to better understand changes over your experiment, and so on. There are several ways of generating samples for any purpose but the following made use of Pandas and Numpy to make it simple.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="c1"># Create a dataframe and rename columns </span>
</span></span><span class="line"><span class="cl"><span class="c1"># Eg. 1</span>
</span></span><span class="line"><span class="cl"><span class="n">foo</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;Col One&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">100</span><span class="p">,</span> <span class="mi">200</span><span class="p">],</span> <span class="s1">&#39;Col Two&#39;</span><span class="p">:</span> <span class="p">[</span><span class="mi">300</span><span class="p">,</span> <span class="mi">400</span><span class="p">]})</span>
</span></span><span class="line"><span class="cl"><span class="n">foo</span><span class="o">.</span><span class="n">rename</span><span class="p">({</span><span class="s1">&#39;Col One&#39;</span><span class="p">:</span> <span class="s1">&#39;col_one&#39;</span><span class="p">,</span> <span class="s1">&#39;Col Two&#39;</span><span class="p">:</span> <span class="s1">&#39;col_two&#39;</span><span class="p">},</span> <span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Eg. 2</span>
</span></span><span class="line"><span class="cl"><span class="n">bar</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">np</span><span class="o">.</span><span class="n">random</span><span class="o">.</span><span class="n">rand</span><span class="p">(</span><span class="mi">4</span><span class="p">,</span> <span class="mi">5</span><span class="p">),</span> <span class="n">columns</span><span class="o">=</span><span class="nb">list</span><span class="p">(</span><span class="s1">&#39;abcde&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl"><span class="n">bar</span><span class="o">.</span><span class="n">add_prefix</span><span class="p">(</span><span class="s1">&#39;X_&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># </span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition question">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-question-circle fa-fw"></i>Output<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>Here we have 2 different ways to create DataFrame and later renaming columns. The first will create a 2 columns and 2 rows DataFrame then renames the column names using the function <code>rename()</code>.</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>col_one</th>
      <th>col_two</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>100</td>
      <td>300</td>
    </tr>
    <tr>
      <th>1</th>
      <td>200</td>
      <td>400</td>
    </tr>
  </tbody>
</table>
<br>
<p>The second consists of constructing random samples and names columns after the list passed over the <code>columns</code> attribute then prefixes these names using the method <code>add_prefix()</code></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>X_a</th>
      <th>X_b</th>
      <th>X_c</th>
      <th>X_d</th>
      <th>X_e</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>0.226161</td>
      <td>0.588816</td>
      <td>0.335782</td>
      <td>0.866124</td>
      <td>0.274059</td>
    </tr>
    <tr>
      <th>1</th>
      <td>0.364500</td>
      <td>0.021647</td>
      <td>0.243754</td>
      <td>0.628392</td>
      <td>0.124118</td>
    </tr>
    <tr>
      <th>2</th>
      <td>0.507057</td>
      <td>0.769180</td>
      <td>0.364644</td>
      <td>0.246468</td>
      <td>0.716658</td>
    </tr>
    <tr>
      <th>3</th>
      <td>0.865142</td>
      <td>0.201212</td>
      <td>0.165379</td>
      <td>0.397729</td>
      <td>0.195590</td>
    </tr>
  </tbody>
</table>
</div>
        </div>
    </div>
<h3 id="4-reverse-row-and-column-order">4. Reverse row and column order</h3>
<p>These are basic operations which consist of reversing the original order of the DataFrame row-wise or column-wise. Here, <code>reset_index()</code> is used to drop the old index and create a new one starting from 0. We can notice the difference between the first and the second output table.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="c1"># Reverse rows</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">loc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Reverse rows and drop the old index </span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">loc</span><span class="p">[::</span><span class="o">-</span><span class="mi">1</span><span class="p">,</span> <span class="p">:]</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Reverse columns</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">loc</span><span class="p">[:,</span> <span class="p">::</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition question">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-question-circle fa-fw"></i>Output<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p><code>police.loc[::-1, :].head(3)</code></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stop_date</th>
      <th>driver_gender</th>
      <th>driver_age_raw</th>
      <th>violation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>91740</th>
      <td>2015-12-31</td>
      <td>M</td>
      <td>1959.0</td>
      <td>Speeding</td>
    </tr>
    <tr>
      <th>91739</th>
      <td>2015-12-31</td>
      <td>M</td>
      <td>1993.0</td>
      <td>Speeding</td>
    </tr>
    <tr>
      <th>91738</th>
      <td>2015-12-31</td>
      <td>M</td>
      <td>1992.0</td>
      <td>Moving violation</td>
    </tr>
  </tbody>
</table>
<br>
<p><code>police.loc[::-1, :].reset_index(drop=True).head(3)</code></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stop_date</th>
      <th>driver_gender</th>
      <th>driver_age_raw</th>
      <th>violation</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2015-12-31</td>
      <td>M</td>
      <td>1959.0</td>
      <td>Speeding</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2015-12-31</td>
      <td>M</td>
      <td>1993.0</td>
      <td>Speeding</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2015-12-31</td>
      <td>M</td>
      <td>1992.0</td>
      <td>Moving violation</td>
    </tr>
  </tbody>
</table>
<br>
<p><code>police.loc[:, ::-1].head(3)</code></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>violation</th>
      <th>driver_age_raw</th>
      <th>driver_gender</th>
      <th>stop_date</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>Speeding</td>
      <td>1985.0</td>
      <td>M</td>
      <td>2005-01-02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Speeding</td>
      <td>1965.0</td>
      <td>M</td>
      <td>2005-01-18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>Speeding</td>
      <td>1972.0</td>
      <td>M</td>
      <td>2005-01-23</td>
    </tr>
  </tbody>
</table>
<br>
</div>
        </div>
    </div>
<h3 id="5-missing-data">5. Missing data</h3>
<p>Missing data is a common problem that we encounter in our data analysis task. In the machine learning task, one can define missing values as missing information that would bring additional information if they are observed<sup id="fnref:1"><a href="#fn:1" class="footnote-ref" role="doc-noteref">1</a></sup>. For that, investigating the missing information plays an important role in the data analysis problem. The following method displays the column-wise percentage of missing data followed by a pythonic way of getting rid of columns having only missing data followed by a tricky way to filter columns out based on the ratio of missing values.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="c1"># Reload the datset with full features</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="s1">&#39;datasets/police_project.csv&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                 <span class="n">sep</span><span class="o">=</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                 <span class="n">parse_dates</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;stop_date&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                 <span class="n">index_col</span><span class="o">=</span><span class="kc">None</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">percent_missing</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;Missing data information summary&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">percent_missing</span> <span class="o">=</span> <span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">isnull</span><span class="p">()</span><span class="o">.</span><span class="n">sum</span><span class="p">()</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span> <span class="o">*</span> <span class="mi">100</span><span class="p">)</span><span class="o">.</span><span class="n">round</span><span class="p">(</span><span class="mi">2</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">missing</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;column_name&#39;</span><span class="p">:</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">,</span> <span class="s1">&#39;percent_missing&#39;</span><span class="p">:</span> <span class="n">percent_missing</span><span class="p">})</span>
</span></span><span class="line"><span class="cl">    <span class="n">missing</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="s1">&#39;percent_missing&#39;</span><span class="p">,</span> <span class="n">ascending</span><span class="o">=</span><span class="kc">False</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">missing</span><span class="o">.</span><span class="n">reset_index</span><span class="p">(</span><span class="n">drop</span><span class="o">=</span><span class="kc">True</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">missing</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">remove_missing</span><span class="p">(</span><span class="n">data</span><span class="p">,</span> <span class="n">keep_ratio</span><span class="o">=</span><span class="mf">.9</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;Missing data removal&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span> <span class="o">=</span> <span class="n">data</span><span class="o">.</span><span class="n">copy</span><span class="p">()</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># The pythonic way of getting rid of columns having only missing values</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="s2">&#34;columns&#34;</span><span class="p">,</span> <span class="n">how</span><span class="o">=</span><span class="s1">&#39;all&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Keep columns having at least 90%(default value of keep_ratio)</span>
</span></span><span class="line"><span class="cl">    <span class="n">df</span><span class="o">.</span><span class="n">dropna</span><span class="p">(</span><span class="n">axis</span><span class="o">=</span><span class="mi">1</span><span class="p">,</span> <span class="n">thresh</span><span class="o">=</span><span class="nb">len</span><span class="p">(</span><span class="n">df</span><span class="p">)</span><span class="o">*</span><span class="n">keep_ratio</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="c1"># Alternative using index </span>
</span></span><span class="line"><span class="cl">    <span class="c1">#df = df[df.columns[df.isna().sum()/df.shape[0] &lt; 0.9 ]]</span>
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">df</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="c1"># Missing data summary </span>
</span></span><span class="line"><span class="cl"><span class="n">missing</span> <span class="o">=</span> <span class="n">percent_missing</span><span class="p">(</span><span class="n">police</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">missing</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Keep columns having at least 90% values</span>
</span></span><span class="line"><span class="cl"><span class="n">new_police</span> <span class="o">=</span> <span class="n">remove_missing</span><span class="p">(</span><span class="n">police</span><span class="p">,</span> <span class="mf">.9</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">new_missing</span> <span class="o">=</span> <span class="n">percent_missing</span><span class="p">(</span><span class="n">new_police</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">new_missing</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition question">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-question-circle fa-fw"></i>Output<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p><code>police</code> dataset</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stop_date</th>
      <th>stop_time</th>
      <th>county_name</th>
      <th>driver_gender</th>
      <th>driver_age_raw</th>
      <th>driver_age</th>
      <th>driver_race</th>
      <th>violation_raw</th>
      <th>violation</th>
      <th>search_conducted</th>
      <th>search_type</th>
      <th>stop_outcome</th>
      <th>is_arrested</th>
      <th>stop_duration</th>
      <th>drugs_related_stop</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2005-01-02</td>
      <td>01:55</td>
      <td>NaN</td>
      <td>M</td>
      <td>1985.0</td>
      <td>20.0</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2005-01-18</td>
      <td>08:15</td>
      <td>NaN</td>
      <td>M</td>
      <td>1965.0</td>
      <td>40.0</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2005-01-23</td>
      <td>23:15</td>
      <td>NaN</td>
      <td>M</td>
      <td>1972.0</td>
      <td>33.0</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
    </tr>
  </tbody>
</table>
<p>Missing data summary: <code>missing</code></p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>missing %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>county_name</td>
      <td>100.00</td>
    </tr>
    <tr>
      <th>1</th>
      <td>search_type</td>
      <td>96.52</td>
    </tr>
    <tr>
      <th>2</th>
      <td>driver_age</td>
      <td>6.13</td>
    </tr>
    <tr>
      <th>3</th>
      <td>driver_gender</td>
      <td>5.82</td>
    </tr>
    <tr>
      <th>4</th>
      <td>driver_age_raw</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>5</th>
      <td>driver_race</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>6</th>
      <td>violation_raw</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>7</th>
      <td>violation</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>8</th>
      <td>stop_outcome</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>9</th>
      <td>is_arrested</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>10</th>
      <td>stop_duration</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>11</th>
      <td>stop_date</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>12</th>
      <td>stop_time</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>13</th>
      <td>search_conducted</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>14</th>
      <td>drugs_related_stop</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
<p>Keep columns contain at least 90% values: <code>new_missing</code> <br>
Here we can notice that the features get reduced. The first two columns <code>county_name</code> and <code>search_type</code> have been removed as they held missing values beyond the defined ratio.</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>features</th>
      <th>missing %</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>driver_age</td>
      <td>6.13</td>
    </tr>
    <tr>
      <th>1</th>
      <td>driver_gender</td>
      <td>5.82</td>
    </tr>
    <tr>
      <th>2</th>
      <td>driver_age_raw</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>3</th>
      <td>driver_race</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>4</th>
      <td>violation_raw</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>5</th>
      <td>violation</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>6</th>
      <td>stop_outcome</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>7</th>
      <td>is_arrested</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>8</th>
      <td>stop_duration</td>
      <td>5.81</td>
    </tr>
    <tr>
      <th>9</th>
      <td>stop_date</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>10</th>
      <td>stop_time</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>11</th>
      <td>search_conducted</td>
      <td>0.00</td>
    </tr>
    <tr>
      <th>12</th>
      <td>drugs_related_stop</td>
      <td>0.00</td>
    </tr>
  </tbody>
</table>
</div>
        </div>
    </div>
<h3 id="6-split-cells-data">6. Split cells data</h3>
<p>Splitting data is useful while dealing with <code>object</code> or <code>category</code> like data types. Let us assume that we are interested in splitting the <code>stop_date</code> into <code>day</code>, <code>month</code>, and <code>year</code>. There are at least two ways of doing so. The first and easiest approach is to treat the attribute <code>stop_date</code> as <code>string</code> and apply the transformation onto the string since there exists a couple of string manipulation helper on Python. But in our case, <code>stop_date</code> has already parsed to <code>datetime64</code> while loading the dataset. By using the string helper functions, we are obliged to downcast again the field into <code>str</code> then applying split to the data afterward. This is computationally expensive when having millions of rows. The second approach comes into play to address this problem. In this, we treat the attribute as <code>datetime64</code> and apply directly the transformation onto it.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl"><span class="c1"># Approach 1.1: string parsing</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="p">[[</span><span class="s1">&#39;year&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;day&#39;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">police</span><span class="p">[</span><span class="s1">&#39;stop_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">astype</span><span class="p">(</span><span class="nb">str</span><span class="p">)</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Approach 1.2: string parsing</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">police</span><span class="p">[</span><span class="s2">&#34;stop_date&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">0</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">police</span><span class="p">[</span><span class="s2">&#34;stop_date&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">1</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">police</span><span class="p">[</span><span class="s2">&#34;stop_date&#34;</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="nb">str</span><span class="p">(</span><span class="n">x</span><span class="p">)</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;-&#39;</span><span class="p">)[</span><span class="mi">2</span><span class="p">])</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Approach 2: datetime parsing</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">police</span><span class="p">[</span><span class="s1">&#39;stop_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">day</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="p">[</span><span class="s1">&#39;month&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">police</span><span class="p">[</span><span class="s1">&#39;stop_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">month</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="p">[</span><span class="s1">&#39;year&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">police</span><span class="p">[</span><span class="s1">&#39;stop_date&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">dt</span><span class="o">.</span><span class="n">year</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">head</span><span class="p">(</span><span class="mi">3</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">police</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[</span><span class="s1">&#39;day&#39;</span><span class="p">,</span> <span class="s1">&#39;month&#39;</span><span class="p">,</span> <span class="s1">&#39;year&#39;</span><span class="p">],</span> <span class="n">inplace</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition question">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-question-circle fa-fw"></i>Output<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>The string parsing approach will produce the same output though there is a slight difference in the way how the data is being parsed in this case. The first method via <code>astype()</code> will parse the date while the data is loaded as <code>datetime64</code> whereas the <code>lambda()</code> function will process right after the data has been loaded. Therefore, the first one will have the <code>day</code> string whereas the second will get the <code>day</code> along with the <code>time</code> which is a set of <code>hour</code>, <code>minute</code>, and <code>second</code>.<br>
The DateTime parsing is an in-built Pandas feature that can only apply to columns of type <code>datetime</code> but is the most convenient way to extract date components.</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>stop_date</th>
      <th>stop_time</th>
      <th>county_name</th>
      <th>driver_gender</th>
      <th>driver_age_raw</th>
      <th>driver_age</th>
      <th>driver_race</th>
      <th>violation_raw</th>
      <th>violation</th>
      <th>search_conducted</th>
      <th>search_type</th>
      <th>stop_outcome</th>
      <th>is_arrested</th>
      <th>stop_duration</th>
      <th>drugs_related_stop</th>
      <th>year</th>
      <th>month</th>
      <th>day</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>2005-01-02</td>
      <td>01:55</td>
      <td>NaN</td>
      <td>M</td>
      <td>1985.0</td>
      <td>20.0</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>2005</td>
      <td>01</td>
      <td>02</td>
    </tr>
    <tr>
      <th>1</th>
      <td>2005-01-18</td>
      <td>08:15</td>
      <td>NaN</td>
      <td>M</td>
      <td>1965.0</td>
      <td>40.0</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>2005</td>
      <td>01</td>
      <td>18</td>
    </tr>
    <tr>
      <th>2</th>
      <td>2005-01-23</td>
      <td>23:15</td>
      <td>NaN</td>
      <td>M</td>
      <td>1972.0</td>
      <td>33.0</td>
      <td>White</td>
      <td>Speeding</td>
      <td>Speeding</td>
      <td>False</td>
      <td>NaN</td>
      <td>Citation</td>
      <td>False</td>
      <td>0-15 Min</td>
      <td>False</td>
      <td>2005</td>
      <td>01</td>
      <td>23</td>
    </tr>
  </tbody>
</table>
</div>
        </div>
    </div>
<p>The same operation can easily be applied to <code>object</code> or <code>category</code> data types</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-Python" data-lang="Python"><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">({</span><span class="s1">&#39;fullname&#39;</span><span class="p">:[</span><span class="s1">&#39;John Doe McArthur&#39;</span><span class="p">,</span> <span class="s1">&#39;Jane Smith McDonald&#39;</span><span class="p">],</span>
</span></span><span class="line"><span class="cl">                   <span class="s1">&#39;address&#39;</span><span class="p">:[</span><span class="s1">&#39;Los Angeles, CA&#39;</span><span class="p">,</span> <span class="s1">&#39;Washington, DC&#39;</span><span class="p">]})</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Split fullname using space or tab as criteria</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[</span><span class="s1">&#39;fullname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Split fullname using the same criteria and rename the newly generated columns</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[[</span><span class="s2">&#34;first&#34;</span><span class="p">,</span> <span class="s2">&#34;middle&#34;</span><span class="p">,</span> <span class="s2">&#34;last&#34;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;fullname&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;\s+&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Split location into city and state using comma as criteria </span>
</span></span><span class="line"><span class="cl"><span class="n">df</span><span class="p">[[</span><span class="s2">&#34;City&#34;</span><span class="p">,</span> <span class="s2">&#34;State&#34;</span><span class="p">]]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="s1">&#39;address&#39;</span><span class="p">]</span><span class="o">.</span><span class="n">str</span><span class="o">.</span><span class="n">split</span><span class="p">(</span><span class="s1">&#39;,&#39;</span><span class="p">,</span> <span class="n">expand</span><span class="o">=</span><span class="kc">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div class="details admonition question">
        <div class="details-summary admonition-title">
            <i class="icon fas fa-question-circle fa-fw"></i>Output<i class="details-icon fas fa-angle-right fa-fw"></i>
        </div>
        <div class="details-content">
            <div class="admonition-content"><p>The dataframe looks like</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fullname</th>
      <th>address</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Doe McArthur</td>
      <td>Los Angeles, CA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jane Smith McDonald</td>
      <td>Washington, DC</td>
    </tr>
  </tbody>
</table>
<p>After splitting <code>fullname</code> by space, it will generate three fields</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>0</th>
      <th>1</th>
      <th>2</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John</td>
      <td>Doe</td>
      <td>McArthur</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jane</td>
      <td>Smith</td>
      <td>McDonald</td>
    </tr>
  </tbody>
</table>
<p>After splitting <code>fullname</code> and <code>address</code>, the generated fields have now their own header names</p>
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>fullname</th>
      <th>address</th>
      <th>First</th>
      <th>Middle</th>
      <th>Last</th>
      <th>City</th>
      <th>State</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>John Doe McArthur</td>
      <td>Los Angeles, CA</td>
      <td>John</td>
      <td>Doe</td>
      <td>McArthur</td>
      <td>Los Angeles</td>
      <td>CA</td>
    </tr>
    <tr>
      <th>1</th>
      <td>Jane Smith McDonald</td>
      <td>Washington, DC</td>
      <td>Jane</td>
      <td>Smith</td>
      <td>McDonald</td>
      <td>Washington</td>
      <td>DC</td>
    </tr>
  </tbody>
</table>
</div>
        </div>
    </div>
<h3 id="7-filter-a-dataframe">7. Filter a dataframe</h3>
<p>What makes a Pandas dataframe different from the other multi-dimensional data structures like Numpy is the way how it organizes the dataset to ease the manipulation task. Pandas makes use of index at every dimension of data in a Series or DataFrame. The index serves as label for each and every row and column to allow users accessing any specific set of cells. This makes the filtering tasks pretty straightforward. Indexes are, by default, of type integer unless it has explicitly preset. <br>
There are multiple ways to access the indexes but two of them are common amongst the data science community including <strong>indexing operator</strong> which refers to the brackets, <strong>[]</strong> directly attached after a Series or DataFrame, and <strong>indexers</strong> that are in-built attributes of a Series and DataFrame like <code>.iloc</code> and <code>.loc</code>. <br>
Alike to the previous approach, I will give some set of examples in the following from which you can easly derive for your own use case.</p>
<div class="footnotes" role="doc-endnotes">
<hr>
<ol>
<li id="fn:1">
<p><a href="https://towardsdatascience.com/all-about-missing-data-handling-b94b8b5d2184" target="_blank" rel="noopener noreffer">All about missing data handling</a>, by Baijayanta Roy&#160;<a href="#fnref:1" class="footnote-backref" role="doc-backlink">&#x21a9;&#xfe0e;</a></p>
</li>
</ol>
</div></div><div class="post-footer" id="post-footer">
    <div class="post-info">
        <div class="post-info-line">
            <div class="post-info-mod">
                <span>Updated on Aug 3, 2022</span>
            </div>
            <div class="post-info-license"></div>
        </div>
        <div class="post-info-line">
            <div class="post-info-md"></div>
            <div class="post-info-share">
                <span><a href="javascript:void(0);" title="Share on Twitter" data-sharer="twitter" data-url="https://ranaivo-it.github.io/me/posts/pandas-best-practice/" data-title="Pandas Best Practices" data-via="naivomah3" data-hashtags="pandas,data_analysis"><i class="fab fa-twitter fa-fw"></i></a><a href="javascript:void(0);" title="Share on Facebook" data-sharer="facebook" data-url="https://ranaivo-it.github.io/me/posts/pandas-best-practice/" data-hashtag="pandas"><i class="fab fa-facebook-square fa-fw"></i></a><a href="javascript:void(0);" title="Share on Linkedin" data-sharer="linkedin" data-url="https://ranaivo-it.github.io/me/posts/pandas-best-practice/"><i class="fab fa-linkedin fa-fw"></i></a><a href="javascript:void(0);" title="Share on WhatsApp" data-sharer="whatsapp" data-url="https://ranaivo-it.github.io/me/posts/pandas-best-practice/" data-title="Pandas Best Practices" data-web><i class="fab fa-whatsapp fa-fw"></i></a></span>
            </div>
        </div>
    </div>

    <div class="post-info-more">
        <section class="post-tags"><i class="fas fa-tags fa-fw"></i>&nbsp;<a href="https://ranaivo-it.github.io/me/tags/pandas/">pandas</a>,&nbsp;<a href="https://ranaivo-it.github.io/me/tags/data_analysis/">data_analysis</a></section>
        <section>
            <span><a href="javascript:void(0);" onclick="window.history.back();">Back</a></span>&nbsp;|&nbsp;<span><a href="https://ranaivo-it.github.io/me/">Home</a></span>
        </section>
    </div>

    <div class="post-nav"></div>
</div>
<div id="comments"><div id="disqus_thread" class="comment"></div><noscript>
                Please enable JavaScript to view the comments powered by <a href="https://disqus.com/?ref_noscript">Disqus</a>.
            </noscript></div></article></div>
            </main><footer class="footer">
    <div class="footer-container"><div class="footer-line"><span class="author" itemprop="copyrightHolder">&nbsp;<a
                    href="https://ranaivo-it.github.io/me/"
                    target="_blank">Mahery Ranaivoson</a></span>&nbsp;|&nbsp;<span class="license"><a rel="license external nofollow noopener noreffer" href="https://creativecommons.org/licenses/by-nc/4.0/" target="_blank">CC BY-NC 4.0</a></span></div>
    </div>
</footer></div>

        <div id="fixed-buttons"><a href="#" id="back-to-top" class="fixed-button" title="Back to Top">
                <i class="fas fa-arrow-up fa-fw"></i>
            </a><a href="#" id="view-comments" class="fixed-button" title="View Comments">
                <i class="fas fa-comment fa-fw"></i>
            </a>
        </div><link rel="stylesheet" href="https://ranaivo-it.github.io/me/lib/lightgallery/lightgallery.min.css"><link rel="stylesheet" href="https://ranaivo-it.github.io/me/lib/katex/katex.min.css"><link rel="stylesheet" href="https://ranaivo-it.github.io/me/lib/katex/copy-tex.min.css"><link rel="stylesheet" href="https://ranaivo-it.github.io/me/lib/cookieconsent/cookieconsent.min.css"><script type="text/javascript" src="https://polyfill.io/v3/polyfill.min.js?features=Array.prototype.fill%2CArray.prototype.find%2CArray.from%2CIntersectionObserver%2CMath.sign%2CObject.assign%2CPromise%2CObject.entries%2CElement.prototype.closest%2CrequestAnimationFrame%2CCustomEvent%2Chtml5shiv%2CObject.values%2Cfetch%2CElement.prototype.after"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/object-fit-images/ofi.min.js"></script><script type="text/javascript" src="https://www-naivo-net.disqus.com/embed.js" defer></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/smooth-scroll/smooth-scroll.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/lazysizes/lazysizes.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/twemoji/twemoji.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/lightgallery/lightgallery.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/lightgallery/lg-thumbnail.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/lightgallery/lg-zoom.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/clipboard/clipboard.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/sharer/sharer.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/katex/katex.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/katex/auto-render.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/katex/copy-tex.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/katex/mhchem.min.js"></script><script type="text/javascript" src="https://ranaivo-it.github.io/me/lib/cookieconsent/cookieconsent.min.js"></script><script type="text/javascript">window.config={"code":{"copyTitle":"Copy to clipboard","maxShownLines":50},"comment":{},"cookieconsent":{"content":{"dismiss":"Got it!","link":"Learn more","message":"This website uses Cookies to improve your experience."},"enable":true,"palette":{"button":{"background":"#f0f0f0"},"popup":{"background":"#1aa3ff"}},"theme":"edgeless"},"lightGallery":{"actualSize":false,"exThumbImage":"data-thumbnail","hideBarsDelay":2000,"selector":".lightgallery","speed":400,"thumbContHeight":80,"thumbWidth":80,"thumbnail":true},"math":{"delimiters":[{"display":true,"left":"$$","right":"$$"},{"display":true,"left":"\\[","right":"\\]"},{"display":false,"left":"$","right":"$"},{"display":false,"left":"\\(","right":"\\)"}],"strict":false},"twemoji":true};</script><script type="text/javascript" src="https://ranaivo-it.github.io/me/js/theme.min.js"></script></body>
</html>
